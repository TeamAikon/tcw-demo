{"version":3,"file":"index.js","sources":["../src/OreIdContext/OreIdContext.tsx","../src/components/Observables/Observables.tsx","../src/components/OreidProvider/OreIdProvider.tsx","../src/hooks/useIsLoggedIn/useIsLoggedIn.ts","../src/hooks/useOreId/useOreId.ts","../src/hooks/useUser/useUser.ts"],"sourcesContent":["import { createContext } from \"react\";\nimport { OreId, UserData } from \"oreid-js\";\n\nexport const OreIdContext = createContext<{\n\toreId: OreId;\n\tuser: UserData | undefined;\n\tsetUser: (user: UserData | undefined) => void;\n\tisLoggedIn: boolean;\n\tsetIsLoggedIn: (isLoggedIn: boolean) => void;\n\taccessToken: string | undefined;\n\tsetAccessToken: (accessToken: string | undefined) => void;\n}>({\n\t//@ts-ignore\n\toreId: undefined,\n\tuser: undefined,\n\tsetUser: () => undefined,\n\tisLoggedIn: false,\n\tsetIsLoggedIn: () => undefined,\n\taccessToken: undefined,\n\tsetAccessToken: () => undefined,\n});\n","// @ts-nocheck\n\nimport { Auth, User } from \"oreid-js\";\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { OreIdContext } from \"src/OreIdContext\";\n\ninterface Props {}\nexport const Observables: React.FC<Props> = () => {\n\tconst { oreId, setUser, setAccessToken, setIsLoggedIn } =\n\t\tuseContext(OreIdContext);\n\tconst [authUser, setAuthUser] = useState<User | undefined>(oreId.auth.user);\n\n\tconst updateUserState = useCallback(\n\t\t(newUser: User) => {\n\t\t\ttry {\n\t\t\t\tsetUser(newUser?.data);\n\t\t\t} catch (err) {\n\t\t\t\tsetUser(undefined);\n\t\t\t}\n\t\t},\n\t\t[setUser]\n\t);\n\n\tconst updateOreIdState = useCallback(\n\t\t(auth: Auth) => {\n\t\t\tsetAuthUser(auth?.user);\n\t\t\tsetIsLoggedIn(auth.isLoggedIn);\n\t\t\tsetAccessToken(auth.accessToken);\n\t\t},\n\t\t[setAuthUser, setIsLoggedIn, setAccessToken]\n\t);\n\n\tuseEffect(() => {\n\t\toreId.auth.subscribe(updateOreIdState);\n\t\treturn () => {\n\t\t\toreId.auth.unsubscribe(updateOreIdState);\n\t\t};\n\t}, [oreId, updateOreIdState]);\n\n\tuseEffect(() => {\n\t\tif (!authUser) return;\n\t\tauthUser.subscribe(updateUserState);\n\t\tauthUser.getData().catch(() => {\n\t\t\t// ! If it fails, nothing needs to be done.\n\t\t\t// ! This function should stay here to prevent the error alert from appearing in the console\n\t\t});\n\t\treturn () => {\n\t\t\tauthUser.unsubscribe(updateUserState);\n\t\t};\n\t}, [authUser]);\n\n\treturn null;\n};\n","import React, { useEffect } from \"react\";\nimport { OreId, UserData } from \"oreid-js\";\nimport { OreIdContext } from \"src/OreIdContext\";\nimport { useState } from \"react\";\nimport { Observables } from \"../Observables\";\n\ninterface Props {\n\toreId: OreId;\n\tchildren: React.ReactNode;\n}\nexport const OreidProvider: React.FC<Props> = ({ children, oreId }) => {\n\tconst [user, setUser] = useState<UserData | undefined>(undefined);\n\tconst [isLoggedIn, setIsLoggedIn] = useState(false);\n\tconst [accessToken, setAccessToken] = useState<string | undefined>(undefined);\n\n\tuseEffect(() => {\n\t\tif (typeof window === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\t\tif (!oreId.isInitialized) {\n\t\t\toreId.init();\n\t\t}\n\t}, []);\n\n\treturn (\n\t\t<OreIdContext.Provider\n\t\t\tvalue={{\n\t\t\t\toreId,\n\t\t\t\tuser,\n\t\t\t\tsetUser,\n\t\t\t\tisLoggedIn,\n\t\t\t\tsetIsLoggedIn,\n\t\t\t\taccessToken,\n\t\t\t\tsetAccessToken,\n\t\t\t}}\n\t\t>\n\t\t\t<Observables />\n\t\t\t{children}\n\t\t</OreIdContext.Provider>\n\t);\n};\n","import { useContext } from \"react\";\nimport { OreIdContext } from \"src/OreIdContext\";\n\nexport const useIsLoggedIn = () => {\n\tconst { isLoggedIn } = useContext(OreIdContext);\n\treturn isLoggedIn;\n};\n","import { useContext } from \"react\";\nimport { OreIdContext } from \"src/OreIdContext\";\n\nexport const useOreId = () => {\n\tconst { oreId } = useContext(OreIdContext);\n\treturn oreId;\n};\n","import { useContext } from \"react\";\nimport { OreIdContext } from \"src/OreIdContext\";\n\nexport const useUser = () => {\n\tconst { user } = useContext(OreIdContext);\n\treturn user;\n};\n"],"names":["createContext","useContext","useState","useCallback","useEffect","React"],"mappings":"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"}